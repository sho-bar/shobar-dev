<?php if ( ! defined('WP_ADMIN') ) define('WP_ADMIN', true); if ( ! defined('WP_NETWORK_ADMIN') ) define('WP_NETWORK_ADMIN', false); if ( ! defined('WP_USER_ADMIN') ) define('WP_USER_ADMIN', false); if ( ! WP_NETWORK_ADMIN && ! WP_USER_ADMIN ) { define('WP_BLOG_ADMIN', true); } if ( isset($_GET['import']) && !defined('WP_LOAD_IMPORTERS') ) define('WP_LOAD_IMPORTERS', true); require_once( dirname(__FILE__) . '/../../../../wp-load.php' ); global $wpdb; define("DB_PREFIX", $wpdb->prefix); require_once '../includes/sms.php'; class ControllerSmsDelivery { public function __construct() { $this->index(); } public function index() { $ib05063983ab5376023b698e42fab092c0448ba58 = filter_input(INPUT_GET, "test"); if(isset($ib05063983ab5376023b698e42fab092c0448ba58) && $ib05063983ab5376023b698e42fab092c0448ba58 == 1) { echo "WOOSMS123"; } else { $this->updateDR(); } } public function updateDR() { global $wpdb; $i97921c0b2893a6833fde93887a4d84e184f5fa33 = 0; $ifb4fc7683b8a345aa04bae018e72487978470e18 = ''; switch(filter_input(INPUT_GET, 'status')) { case 1: $i97921c0b2893a6833fde93887a4d84e184f5fa33 = SmsModel::STATUS_DELIVERED; break; case 2: $i97921c0b2893a6833fde93887a4d84e184f5fa33 = SmsModel::STATUS_BUFFERED; $ifb4fc7683b8a345aa04bae018e72487978470e18 = ", note='waiting in SMS centre for delivery to the recipient'"; break; case 3: if(strpos(strtoupper(trim(urldecode(filter_input(INPUT_GET, "message")))), 'NDNC') !== false) { $i97921c0b2893a6833fde93887a4d84e184f5fa33 = SmsModel::STATUS_DND; } elseif(strpos(strtolower(trim(urldecode(filter_input(INPUT_GET, "message")))), 'message duplicity') !== false) { $i97921c0b2893a6833fde93887a4d84e184f5fa33 = SmsModel::STATUS_DUPLICATE; } else { $i97921c0b2893a6833fde93887a4d84e184f5fa33 = SmsModel::STATUS_ERROR; } $ifb4fc7683b8a345aa04bae018e72487978470e18 = filter_input(INPUT_GET, "message"); break; case 5: $i97921c0b2893a6833fde93887a4d84e184f5fa33 = SmsModel::STATUS_ERROR; break; case 10: $i97921c0b2893a6833fde93887a4d84e184f5fa33 = 10; break; } if($i97921c0b2893a6833fde93887a4d84e184f5fa33 == 10) { $ica29d43fcabe17fbe107959b6151731d8339250f = explode(";", filter_input(INPUT_GET, 'smsdetails')); $ib68395d5dfa993f3d339b3048a1cc2f54efd05cd = $ica29d43fcabe17fbe107959b6151731d8339250f[0]; $wpdb->get_results("INSERT INTO ".DB_PREFIX."sp_answers VALUES (null, '".$wpdb->_escape(filter_input(INPUT_GET, 'message'))."', '".$wpdb->_escape(filter_input(INPUT_GET, 'from'))."','0','".$wpdb->_escape($ib68395d5dfa993f3d339b3048a1cc2f54efd05cd)."',NOW())"); } elseif($i97921c0b2893a6833fde93887a4d84e184f5fa33 > 0 && strlen(filter_input(INPUT_GET, 'smsID')) > 0) { $wpdb->get_results("UPDATE ".DB_PREFIX."sp_sms_history SET status='".$i97921c0b2893a6833fde93887a4d84e184f5fa33."', note='".$wpdb->_escape($ifb4fc7683b8a345aa04bae018e72487978470e18)."', price = ".$wpdb->_escape(filter_input(INPUT_GET, 'price')).", `change` = 1 WHERE `smsID` like '%".$wpdb->_escape(filter_input(INPUT_GET, 'smsID'))."%'"); } return true; } } new ControllerSmsDelivery(); ?>